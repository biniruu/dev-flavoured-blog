"use strict";(self.webpackChunkdev_flavoured_blog=self.webpackChunkdev_flavoured_blog||[]).push([[692],{4765:function(e,t,n){n.d(t,{F:function(){return p},Z:function(){return d}});var a=n(7294),r=n(8733),l=n(795),c=n(1322),o=n(6799),s=n(8871);var m=e=>{let{post:t}=e;return null};const i=["16px","8px","4px"].map((e=>"rgba(0, 0, 0, 0.1) 0px "+e+" "+e+" 0px"));var u=e=>{let{data:{post:t},children:n}=e;return(0,r.tZ)(c.Z,null,(0,r.tZ)(l.X6,{as:"h1",variant:"styles.h1"},t.title),(0,r.tZ)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,r.tZ)("time",null,t.date),t.tags&&(0,r.tZ)(a.Fragment,null," — ",(0,r.tZ)(o.Z,{tags:t.tags})),t.timeToRead&&" — ",t.timeToRead&&(0,r.tZ)("span",null,t.timeToRead," min read")),(0,r.tZ)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:i.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},n),(0,r.tZ)(m,{post:t}))};const p=e=>{var t,n,a;let{data:{post:l}}=e;return(0,r.tZ)(s.Z,{title:l.title,description:l.description?l.description:l.excerpt,image:l.banner?null===(t=l.banner)||void 0===t||null===(n=t.childImageSharp)||void 0===n||null===(a=n.resize)||void 0===a?void 0:a.src:void 0,pathname:l.slug,canonicalUrl:l.canonicalUrl})};function d(e){let{...t}=e;return a.createElement(u,t)}},6799:function(e,t,n){var a=n(8733),r=n(7294),l=n(1883),c=n(3494),o=n(9706);t.Z=e=>{let{tags:t}=e;const{tagsPath:n,basePath:s}=(0,c.Z)();return(0,a.tZ)(r.Fragment,null,t.map(((e,t)=>(0,a.tZ)(r.Fragment,{key:e.slug},!!t&&", ",(0,a.tZ)(l.Link,{sx:e=>{var t;return{...null===(t=e.styles)||void 0===t?void 0:t.a}},to:(0,o.Z)("/"+s+"/"+n+"/"+e.slug)},e.name)))))}},8871:function(e,t,n){var a=n(7294),r=n(1883),l=n(4232);t.Z=e=>{let{title:t="",description:n="",pathname:c="",image:o="",children:s=null,canonicalUrl:m=""}=e;const i=(0,l.Z)(),{siteTitle:u,siteTitleAlt:p,siteUrl:d,siteDescription:h,siteImage:E,author:g,siteLanguage:b}=i,f={title:t?t+" | "+u:p,description:n||h,url:""+d+(c||""),image:""+d+(o||E)};return a.createElement(a.Fragment,null,a.createElement("html",{lang:b}),a.createElement("title",null,f.title),a.createElement("meta",{name:"description",content:f.description}),a.createElement("meta",{name:"image",content:f.image}),a.createElement("meta",{property:"og:title",content:f.title}),a.createElement("meta",{property:"og:url",content:f.url}),a.createElement("meta",{property:"og:description",content:f.description}),a.createElement("meta",{property:"og:image",content:f.image}),a.createElement("meta",{property:"og:type",content:"website"}),a.createElement("meta",{property:"og:image:alt",content:f.description}),a.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),a.createElement("meta",{name:"twitter:title",content:f.title}),a.createElement("meta",{name:"twitter:url",content:f.url}),a.createElement("meta",{name:"twitter:description",content:f.description}),a.createElement("meta",{name:"twitter:image",content:f.image}),a.createElement("meta",{name:"twitter:image:alt",content:f.description}),a.createElement("meta",{name:"twitter:creator",content:g}),a.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,r.withPrefix)("/favicon-32x32.png")}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,r.withPrefix)("/favicon-16x16.png")}),a.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,r.withPrefix)("/apple-touch-icon.png")}),m?a.createElement("link",{rel:"canonical",href:m}):null,s)}},7200:function(e,t,n){n.r(t),n.d(t,{Head:function(){return o.F},default:function(){return s}});var a=n(7294),r=n(1151);function l(e){const t=Object.assign({blockquote:"blockquote",p:"p",code:"code",h2:"h2",pre:"pre",br:"br"},(0,r.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.blockquote,null,"\n",a.createElement(t.p,null,"이 방법은 lodash-es method를 사용하는 파일을 테스트할 때 발생하는 에러를 확실히 해결해줘요. 그렇지만 정확한 또는 추천할 만한 방법인지는 확실하지 않아요."),"\n"),"\n",a.createElement("br"),"\n",a.createElement(t.p,null,"리액트에서 ",a.createElement(t.code,null,"debounce"),"를 사용한 컴포넌트를 jest로 테스트하다 문제가 발생했어요."),"\n",a.createElement(t.p,null,"이 문제를 다룬 글을 찾기가 어려워서 해결하는 데 시간이 꽤 많이 들더라고요."),"\n",a.createElement(t.p,null,"저와 같은 상황을 마주쳤다면 이 글이 도움이 될 거라 생각해요."),"\n",a.createElement("br"),"\n",a.createElement(t.h2,null,"에러 발생"),"\n",a.createElement("br"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-typescript"},"// Searchbar.tsx\n\nimport { debounce } from 'lodash-es'\nimport type { ChangeEvent } from 'react'\n\nimport useNavFunc from 'hooks/useNavFunc'\n\nexport function Searchbar() {\n  const { searchParams, replace, pathname } = useNavFunc()\n\n  const handleSearch = debounce((e: ChangeEvent<HTMLInputElement>) => {\n    const params = new URLSearchParams(searchParams)\n    params.set('page', '1')\n    e.target.value ? params.set('search', e.target.value) : params.delete('search')\n    replace(`${pathname}?${params.toString()}`)\n  })\n\n  return (...)\n}\n")),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-typescript"},"// Searchbar.test.tsx\n\nimport { fireEvent, render, screen } from '@testing-library/react'\nimport type { LoDashStatic } from 'lodash'\nimport type { ChangeEvent } from 'react'\n\nimport Searchbar from '@components/searchbar/Searchbar'\n\nconst replace = jest.fn()\n\njest.mock('hooks/useNavFunc', () => ({\n  __esModule: true,\n  default: () => ({\n    searchParams: '',\n    replace,\n    pathname: 'test',\n  }),\n}))\n\n// lodash-es를 mocking하는 부분\njest.mock('lodash-es', () => {\n  return {\n    debounce: jest.fn()\n  }\n})\n\ndescribe('Searchbar component', () => {\n  test('should update input value and URL when user types in search input', () => {\n    render(<Searchbar />)\n    const input = screen.getByTestId(...)\n    fireEvent.change(input, { target: { value: 'hello' } })\n\n    expect(replace).toHaveBeenCalledWith('test?page=1&search=hello')\n  })\n})\n")),"\n",a.createElement(t.blockquote,null,"\n",a.createElement(t.p,null,"Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax."),"\n",a.createElement(t.p,null,"Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration."),"\n",a.createElement(t.p,null,'By default "node_modules" folder is ignored by transformers.'),"\n",a.createElement(t.p,null,"Here's what you can do:\n..."),"\n",a.createElement(t.p,null,"Details:"),"\n",a.createElement(t.p,null,"/Users/biniruu/WebDev/admin-dashboard-nextjs14/node_modules/lodash-es/lodash.js:10",a.createElement(t.br),"\n","export { default as add } from './add.js';",a.createElement(t.br),"\n","^^^^^^"),"\n",a.createElement(t.p,null,"SyntaxError: Unexpected token 'export'"),"\n",a.createElement(t.p,null,"..."),"\n"),"\n",a.createElement("br"),"\n",a.createElement(t.p,null,"에러를 해결하려고 테스트 코드에 별별 방법을 써봐도 효과가 없을 거예요."),"\n",a.createElement(t.p,null,"대신 jest 설정 파일에서 ",a.createElement(t.code,null,"moduleNameMapper")," 옵션에 ",a.createElement(t.code,null,"'lodash-es': 'lodash'"),"를 추가해보세요."),"\n",a.createElement(t.p,null,"에러가 사라질 거예요."),"\n",a.createElement("br"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-typescript"},"// jest.config.ts\n\nmoduleNameMapper: {\n  'lodash-es': 'lodash'\n}\n")),"\n",a.createElement("br"),"\n",a.createElement(t.h2,null,"mocking 한 debounce로 감싼 함수가 실행되지 않는 문제"),"\n",a.createElement(t.p,null,"컴포넌트 파일에서 ",a.createElement(t.code,null,"replace"),"가 실행되는지 테스트하고 싶었는데, ",a.createElement(t.code,null,"debounce"),"를 잘못된 방식으로 mocking 했더니 ",a.createElement(t.code,null,"replace"),"가 실행되지 않는 문제가 발생했어요."),"\n",a.createElement(t.p,null,"테스트 코드에서 ",a.createElement(t.code,null,"lodash-es"),"를 mocking한 부분을 살펴보세요."),"\n",a.createElement(t.p,null,"컴포넌트 파일에서 ",a.createElement(t.code,null,"debounce"),"로 감싼 함수 부분을 테스트 파일에서 mocking한 ",a.createElement(t.code,null,"debounce"),"가 반영하지 못하고 있어요."),"\n",a.createElement(t.p,null,"컴포넌트 파일에서는 ",a.createElement(t.code,null,"debounce"),"가 감싼 함수에서 ",a.createElement(t.code,null,"replace"),"를 실행하는데, 그 함수 부분을 테스트 코드에서 반영하지 못하고 있으니 ",a.createElement(t.code,null,"toHaveBeenCalledWith"),"에서 테스트가 실패할 수밖에 없죠."),"\n",a.createElement("br"),"\n",a.createElement(t.blockquote,null,"\n",a.createElement(t.p,null,"expect(jest.fn()).toHaveBeenCalledWith(...expected)"),"\n",a.createElement(t.p,null,'Expected: "test?page=1&search=hello"'),"\n",a.createElement(t.p,null,"Number of calls: 0"),"\n"),"\n",a.createElement("br"),"\n",a.createElement(t.p,null,"문제가 되는 ",a.createElement(t.code,null,"lodash-es")," mocking 부분을 다음과 같이 바꿨더니 의도한 대로 테스트가 동작했어요."),"\n",a.createElement("br"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-typescript"},"import type { LoDashStatic } from 'lodash'\n\njest.mock('lodash-es', () => {\n  const originalModule: LoDashStatic = jest.requireActual('lodash-es')\n\n  return {\n    ...originalModule,\n    debounce: (fn: ChangeEvent<HTMLInputElement>) => fn,\n  }\n})\n")),"\n",a.createElement("br"),"\n",a.createElement(t.h2,null,"마무리"),"\n",a.createElement(t.p,null,"이제 전체 테스트 코드를 확인하면서 참고할 만한 부분을 찾아 수정해보세요."),"\n",a.createElement("br"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-typescript"},"// Searchbar.test.tsx\n\nimport { fireEvent, render, screen } from '@testing-library/react'\nimport type { LoDashStatic } from 'lodash'\nimport type { ChangeEvent } from 'react'\n\nimport Searchbar from '@components/searchbar/Searchbar'\n\nconst replace = jest.fn()\n\njest.mock('hooks/useNavFunc', () => ({\n  __esModule: true,\n  default: () => ({\n    searchParams: '',\n    replace,\n    pathname: 'test',\n  }),\n}))\n\njest.mock('lodash-es', () => {\n  const originalModule: LoDashStatic = jest.requireActual('lodash-es')\n\n  return {\n    ...originalModule,\n    debounce: (fn: ChangeEvent<HTMLInputElement>) => fn,\n  }\n})\n\ndescribe('Searchbar component', () => {\n  test('should update input value and URL when user types in search input', () => {\n    render(<Searchbar />)\n    const input = screen.getByTestId(...)\n    fireEvent.change(input, { target: { value: 'hello' } })\n\n    expect(replace).toHaveBeenCalledWith('test?page=1&search=hello')\n  })\n})\n")))}var c=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,r.ah)(),e.components);return t?a.createElement(t,e,a.createElement(l,e)):l(e)},o=n(4765);function s(e){return a.createElement(o.Z,e,a.createElement(c,e))}o.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-mock-lodash-es-in-jest-index-mdx-878733ca77dc2dcfc80b.js.map